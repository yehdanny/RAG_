
# 🏥 就醫病症參考：用語意檢索與大型語言模型輔助判斷科別

## ❓ 問題陳述

在現實生活中，許多民眾面對身體不適時，常常無法確定該掛哪一科。例如：「肚子痛但又懷疑是胃還是婦科？」「喉嚨卡卡但不確定是感冒還是過敏？」若能即時提供初步建議，有助於降低誤掛、節省醫療資源並加速就醫流程。

[本專案](https://rag-9qj83ad.gamma.site/)目標為：🧠結合語意向量檢索與大型語言模型（LLM），建構一套「輸入症狀 → 回傳建議科別與解釋」的系統，作為初步就醫決策參考。

---

## 📦 資料與樣本來源

- 由高雄醫學大學醫療網站，症狀與建議科別資料。
- 範例資料（僅供模型訓練與測試使用，非真實診斷）：

|建議科別 | 症狀敘述                              |
|----------|--------------------------------------|
|消化內科 | 吃完東西胃會脹氣且悶痛               | 
|風濕免疫科   | 最近早上起床手指僵硬，難以彎曲         |
|眼科     | 眼睛乾澀刺痛且畏光                   |
|婦產科| 月經來時腹痛明顯，甚至影響工作            |

[source_img](img/source_img.png)

### 經前處理成:

#### 由 科別 + 科別病症敘述，作為格式

[output_img](img/output.png)

---

## 🔍 系統概觀與流程

1. 使用症狀描述建立語意向量索引（Embedding via `OllamaEmbeddings`，模型為 `nomic-embed-text`）。
2. 使用 `FAISS` 做語意檢索，抓出與輸入症狀最相似的描述案例。
3. 使用 `ollama` 根據語意檢索結果給出「建議就醫科別 + 原因說明」。
4. 可依症狀語氣與表達方式調整 prompt，保有彈性與可解釋性。

---

## ✨ 模型與技術

- 向量索引：`FAISS` + `OllamaEmbeddings` （使用 `nomic-embed-text` 模型）
- 語言模型：`ollama`
- 架構：`RAG`（Retrieval-Augmented Generation）
- 系統串接與提示工程：設計 `prompt` 提升醫療相關理解力
- 模型管理與部署：使用 `MLflow` 管理版本與記錄模型回應

---

## 🧠 示意輸出

輸入：
> 我有青春痘，應該看哪一科？

__有RAG__ 回應：
> 根據提供的資料，你應該前往「青少年醫學科」就診。

[w_RAG](img/w_RAG.png)

無RAG 回應：
> 你似乎有少年病（acne），需要看皮膚科。但如果你的情況呈現其他特別性质或有其他健康問題， 可能需要考慮與内科、眼科等相關 專業領域的治療。請務必向医生提供正確的資訊以便取得最佳治療建議。

[wo_RAG](img/wo_RAG.png)


#### 清楚禁止提供任何醫療建議或診斷，降低使用者誤解 AI 回答為正式醫療意見的風險，符合醫療領域對 AI 使用的審慎原則。
---

## 🧰 Prompt？


```python
system_prompt = """
你是一位醫院導診助理，負責根據提供的科別與病症對應資料，協助病人判斷該前往哪一個科別就診。

請根據以下提供的參考內容回答問題：

- 所有回答必須使用繁體中文。
- 不可以出現簡體中文字或非正體中文用語。
- 不可以出現任何醫療建議或診斷。
- 回答中不得使用資料中未提及的醫療術語或專業詞彙。
- 只能根據我提供的情境資料（{context}）回答問題，不可以加入你自己的臆測或知識。
- 如果你無法從提供的內容中找出明確答案，請回應「根據目前資料無法判斷，建議聯絡醫師進一步諮詢。」
- 若有多個科別符合病症，請列出科別。

以下是參考資料：

{context}

"""
```

- 限制知識來源：只根據 給予的資料 回答，避免胡亂猜測。

- 避免法律風險：禁止提供醫療建議，降低責任問題。

- 語言在地化：限定使用繁體中文，提升使用者信任。

- 控制用語範圍：不得擅用醫療術語，確保內容簡明易懂。

- 處理不確定情境：設有標準回應，避免誤導使用者。


---

## 📌 未來方向

- 擴充資料集：增加更多。
- 模型精緻化：訓練針對台灣常見症狀語料的指令微調模型。
- 使用 [MLflow](https://mlflow.org/) 作為核心實驗管理平台。
- 追蹤向量索引版本、LLM 回應、輸入/輸出結果、參數設置等。
- 模型版本控管與部署支援方便後續上線與評估。

---

## ⚠️ 注意事項

- 本專案之建議僅供學術與技術示範用途，**不構成正式醫療建議**。
- 用戶仍應依實際情況尋求專業醫療協助。

---

## 🙌 Link@
### My Github : 
- [github@yehdanny](https://github.com/yehdanny)
- [Website@yehdanny](https://yehdanny.github.io/mypage/html/index.html)
- [Instagram@yeh_const](https://www.instagram.com/yeh_const?igsh=MTVlNTl2eGVkeWI2MA%3D%3D&utm_source=qr)